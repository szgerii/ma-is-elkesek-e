const e="/api/users";function t(){const e=document.querySelector("#input-username"),t=document.querySelector("#input-password"),s=document.querySelector("#input-password2"),l=document.querySelector("#input-submitBtn");let o=!1,d=!1;e.addEventListener("keyup",e=>{13==e.keyCode&&r()}),t.addEventListener("keyup",e=>{13==e.keyCode&&r()}),s.addEventListener("keyup",e=>{13==e.keyCode&&r()}),e.addEventListener("input",e=>{o="correct"===n(e.target.value),l.disabled=!(o&&d&&t.value===s.value)}),t.addEventListener("input",e=>{d="correct"===a(e.target.value),l.disabled=!(o&&d&&t.value===s.value)}),s.addEventListener("input",e=>{l.disabled=!(o&&d&&t.value===s.value)}),document.querySelector("#button-wrapper").addEventListener("click",r)}function r(){const t=document.querySelector("#input-username"),r=document.querySelector("#input-password"),s=document.querySelector("#input-password2"),l="true"==document.querySelector("#input-dd-watchlist").value,o=document.querySelector("#input-submitBtn"),d=document.querySelector("#username-error"),i=document.querySelector("#password-error"),u=document.querySelector("#password-again-error");let c=!1;switch(d.innerText="",i.innerText="",u.innerText="",t.style.border="",r.style.border="",s.style.border="",n(t.value)){case"empty":d.innerText="Kérjük adjon meg egy felhasználónevet",t.style.border=".07em solid rgb(255, 78, 78)",c=!0;break;case"short":d.innerText="A felhasználónévnek legalább 3 karakterből kell állnia",t.style.border=".07em solid rgb(255, 78, 78)",c=!0;break;case"long":d.innerText="A felhasználónév legfeljebb 16 karakterből állhat",t.style.border=".07em solid rgb(255, 78, 78)",c=!0;break;case"incorrect":d.innerText="A felhasználónév csak az angol ABC betűit, számokat, kötőjelet és aláhúzást tartalmazhat",t.style.border=".07em solid rgb(255, 78, 78)",c=!0}switch(a(r.value)){case"empty":i.innerText="Kérjük adjon meg egy jelszót",r.style.border=".07em solid rgb(255, 78, 78)",c=!0;break;case"short":i.innerText="A jelszónak legalább 6 karakterből kell állnia",r.style.border=".07em solid rgb(255, 78, 78)",c=!0}r.value===s.value||c||(c=!0,u.innerText="A két jelszó nem egyezik",s.style.border=".07em solid rgb(255, 78, 78)"),c||(o.disabled=!0,o.value="Kérjük várjon...",fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t.value,password:r.value,showWatchlistByDefault:l})}).then(async e=>({json:await e.json(),status:e.status})).then(e=>{o.value="Regisztráció",o.disabled=!1,"success"===e.json.status?window.location.assign("/"):"fail"===e.json.status?409===e.status?(d.innerText="A megadott felhasználónév már foglalt.",t.style.border=".07em solid rgb(255, 78, 78)"):422===e.status?e.json.data.username?(d.innerText="A megadott felhasználónév formátuma nem megfelelő.",t.style.border=".07em solid rgb(255, 78, 78)"):(i.innerText="A megadott jelszó formátuma nem megfelelő.",r.style.border=".07em solid rgb(255, 78, 78)"):alert("Hiba történt a regisztráció során, kérjük próbálkozzon újra később."):alert("Hiba történt a regisztráció során, kérjük próbálkozzon újra később.")}).catch(e=>{o.value="Bejelentkezés",o.disabled=!1,console.debug(e),i.innerText="Ismeretlen hiba történt a bejelentkezés során, kérjük probálkozzon újra később."}))}function n(e){return""==e?"empty":e.length<3?"short":e.length>16?"long":/^([a-zA-Z0-9_-]){3,16}$/.test(e)?"correct":"incorrect"}function a(e){return""==e?"empty":e.length<6?"short":"correct"}window.addEventListener?window.addEventListener("load",t):window.attachEvent&&window.attachEvent("onload",t);